{"version":3,"sources":["webpack:///./src/components/excel.vue?1f3f","webpack:///src/components/excel.vue","webpack:///./src/components/excel.vue?ee8c","webpack:///./src/components/excel.vue","webpack:///./node_modules/core-js/modules/es.function.name.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","handleRequest","handlePreview","handleRemove","beforeRemove","handleChangefileRule","fileList","handleExceed","_v","handleChangefileDate","handleChangefileTa","on","onSubmitTa","onSubmit","staticRenderFns","sheet2blob","obj","workbook","SheetNames","push","i","Sheets","sheet","openDownloadDialog","url","saveName","name","components","data","tableData","excelList","fileRule","fileDate","fileTa","totleSum","created","getAccountDate","methods","ondownload","window","open","location","origin","console","log","file","raw","$message","warning","$confirm","excelCreatedAndDownload","results","form","append","$http","component","DESCRIPTORS","defineProperty","f","FunctionPrototype","Function","prototype","FunctionPrototypeToString","toString","nameRE","NAME","configurable","get","call","match","error"],"mappings":"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","file":"js/chunk-ec8d9eb4.33b11733.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"excel\"}},[_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"action\":\"\",\"http-request\":_vm.handleRequest,\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"before-remove\":_vm.beforeRemove,\"on-change\":_vm.handleChangefileRule,\"multiple\":\"\",\"limit\":1,\"accept\":\".xlsx\",\"file-list\":_vm.fileList,\"on-exceed\":_vm.handleExceed}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传规则表\")])],1),_c('br'),_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"action\":\"\",\"http-request\":_vm.handleRequest,\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"before-remove\":_vm.beforeRemove,\"on-change\":_vm.handleChangefileDate,\"multiple\":\"\",\"limit\":1,\"accept\":\".xlsx\",\"file-list\":_vm.fileList,\"on-exceed\":_vm.handleExceed}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传待转换表\")])],1),_c('br'),_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"action\":\"\",\"http-request\":_vm.handleRequest,\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"before-remove\":_vm.beforeRemove,\"on-change\":_vm.handleChangefileTa,\"multiple\":\"\",\"limit\":1,\"accept\":\".xlsx\",\"file-list\":_vm.fileList,\"on-exceed\":_vm.handleExceed}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传天安原始表\")])],1),_c('br'),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmitTa}},[_vm._v(\"天安数据合并\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(\"生成最终结果\")]),_c('br')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"excel\">\n    <!-- <h1>天安数据测试中，暂停使用</h1> -->\n    <el-upload\n      class=\"upload-demo\"\n      action=''\n      :http-request=\"handleRequest\"\n      :on-preview=\"handlePreview\"\n      :on-remove=\"handleRemove\"\n      :before-remove=\"beforeRemove\"\n      :on-change=\"handleChangefileRule\"\n      multiple\n      :limit=\"1\"\n      accept=\".xlsx\"\n      :file-list=\"fileList\"\n      :on-exceed=\"handleExceed\">\n      <el-button size=\"small\" type=\"primary\">点击上传规则表</el-button>\n    </el-upload>\n    <br>\n    <el-upload\n      class=\"upload-demo\"\n      action=''\n      :http-request=\"handleRequest\"\n      :on-preview=\"handlePreview\"\n      :on-remove=\"handleRemove\"\n      :before-remove=\"beforeRemove\"\n      :on-change=\"handleChangefileDate\"\n      multiple\n      :limit=\"1\"\n      accept=\".xlsx\"\n      :file-list=\"fileList\"\n      :on-exceed=\"handleExceed\">\n      <el-button size=\"small\" type=\"primary\">点击上传待转换表</el-button>\n    </el-upload>\n    <br>\n    <el-upload\n      class=\"upload-demo\"\n      action=''\n      :http-request=\"handleRequest\"\n      :on-preview=\"handlePreview\"\n      :on-remove=\"handleRemove\"\n      :before-remove=\"beforeRemove\"\n      :on-change=\"handleChangefileTa\"\n      multiple\n      :limit=\"1\"\n      accept=\".xlsx\"\n      :file-list=\"fileList\"\n      :on-exceed=\"handleExceed\">\n      <el-button size=\"small\" type=\"primary\">点击上传天安原始表</el-button>\n    </el-upload>\n    <br>\n    <el-button @click=\"onSubmitTa\" type=\"primary\">天安数据合并</el-button>\n    <el-button @click=\"onSubmit\" type=\"primary\">生成最终结果</el-button>\n    <br>\n    <!-- <el-table\n      :data=\"excelList\"\n      @row-click=\"ondownload\"\n      border\n      style=\"width: 100%\">\n      <el-table-column\n        prop=\"name\"\n        label=\"名称\">\n      </el-table-column>\n    </el-table> -->\n  </div>\n</template>\n\n<script>\n// 将一个sheet转成最终的excel文件的blob对象，然后利用URL.createObjectURL下载\nfunction sheet2blob(obj) {\n\tvar workbook = {\n\t\tSheetNames: [],\n\t\tSheets: {}\n\t};\n  for(let i in obj){\n    let sheet = XLSX.utils.aoa_to_sheet(obj[i]);\n    workbook.SheetNames.push(i);\n    workbook.Sheets[i] = sheet;\n  }\n\t// 生成excel的配置项\n\tvar wopts = {\n\t\tbookType: 'xlsx', // 要生成的文件类型\n\t\tbookSST: false, // 是否生成Shared String Table，官方解释是，如果开启生成速度会下降，但在低版本IOS设备上有更好的兼容性\n\t\ttype: 'binary'\n\t};\n\tvar wbout = XLSX.write(workbook, wopts);\n\tvar blob = new Blob([s2ab(wbout)], {type:\"application/octet-stream\"});\n\t// 字符串转ArrayBuffer\n\tfunction s2ab(s) {\n\t\tvar buf = new ArrayBuffer(s.length);\n\t\tvar view = new Uint8Array(buf);\n\t\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\t\treturn buf;\n\t}\n\treturn blob;\n}\n\nfunction openDownloadDialog(url, saveName)\n{\n\tif(typeof url == 'object' && url instanceof Blob)\n\t{\n\t\turl = URL.createObjectURL(url); // 创建blob地址\n\t}\n\tvar aLink = document.createElement('a');\n\taLink.href = url;\n\taLink.download = saveName || ''; // HTML5新增的属性，指定保存文件名，可以不要后缀，注意，file:///模式下不会生效\n\tvar event;\n\tif(window.MouseEvent) event = new MouseEvent('click');\n\telse\n\t{\n\t\tevent = document.createEvent('MouseEvents');\n\t\tevent.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n\t}\n\taLink.dispatchEvent(event);\n}\nimport XLSX from 'xlsx';\nexport default {\n  name: 'excel',\n  components: {\n  },\n  data() {\n    return {\n      tableData: [],\n      fileList: [],\n      excelList: [],\n      fileRule: null,\n      fileDate: null,\n      fileTa: null,\n      totleSum: 0\n    }\n  },\n  created() {\n    this.getAccountDate();\n  },\n  methods: {\n    ondownload(row){\n      window.open(window.location.origin+'/dist/'+row.name)\n    },\n    handleRequest(){\n      console.log(this.fileList)\n    },\n    handleChangefileRule(file){\n      this.fileRule = file.raw;\n    },\n    handleChangefileDate(file){\n      this.fileDate = file.raw;\n    },\n    handleChangefileTa(file){\n      this.fileTa = file.raw;\n    },\n    handleRemove(file, fileList) {\n      console.log(file, fileList);\n    },\n    handlePreview(file) {\n      console.log(file);\n    },\n    handleExceed() {\n      this.$message.warning(`当前限制选择 1 个文件`);\n    },\n    beforeRemove(file) {\n      return this.$confirm(`确定移除 ${ file.name }？`);\n    },\n    getAccountDate(){\n      // this.$http({\n      //     method: 'get',\n      //     url: '/searchDir',\n      //     data: {}\n      // }).then(res=>{\n      //   this.excelList = res.data.split(';').map(v=>({name:v})).filter(v=>v.name.indexOf('xls')!==-1);\n      //   console.log(res.data,this.excelList)\n      // })\n    },\n    excelCreatedAndDownload(results,name){\n      openDownloadDialog(sheet2blob(results), (name||'导出数据')+'.xlsx');\n    },\n    onSubmit() {\n      if(!this.fileRule){\n        this.$message('请输入规则表');\n        return;\n      }\n      if(!this.fileDate){\n        this.$message('请输入需要待转换表');\n        return;\n      }\n      let form = new FormData();\n      form.append('fileRule', this.fileRule);\n      form.append('fileDate', this.fileDate);\n      this.$http({\n          method: 'post',\n          url: '/searchTest',\n          data: form\n      }).then(res=>{\n        this.excelCreatedAndDownload(res.data)\n      })\n    },\n    onSubmitTa(){\n      if(!this.fileRule){\n        this.$message('请输入规则表');\n        return;\n      }\n      if(!this.fileTa){\n        this.$message('请输入天安原始表');\n        return;\n      }\n      let form = new FormData();\n      form.append('fileRule', this.fileRule);\n      form.append('fileTa', this.fileTa);\n      this.$http({\n          method: 'post',\n          url: '/tamaker',\n          data: form\n      }).then(res=>{\n        this.excelCreatedAndDownload(res.data, '天安转换后数据')\n      })\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./excel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./excel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./excel.vue?vue&type=template&id=d7e06ba6&\"\nimport script from \"./excel.vue?vue&type=script&lang=js&\"\nexport * from \"./excel.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n"],"sourceRoot":""}