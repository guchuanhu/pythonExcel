(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ec8d9eb4"],{2220:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"excel"}},[n("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.handleRequest,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-change":e.handleChangefileRule,multiple:"",limit:1,accept:".xlsx","file-list":e.fileList,"on-exceed":e.handleExceed}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传规则表")])],1),n("br"),n("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.handleRequest,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-change":e.handleChangefileDate,multiple:"",limit:1,accept:".xlsx","file-list":e.fileList,"on-exceed":e.handleExceed}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传待转换表")])],1),n("br"),n("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.handleRequest,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-change":e.handleChangefileTa,multiple:"",limit:1,accept:".xlsx","file-list":e.fileList,"on-exceed":e.handleExceed}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传天安原始表")])],1),n("br"),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitTa}},[e._v("天安数据合并")]),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("生成最终结果")]),n("br")],1)},i=[],l=(n("c19f"),n("b0c0"),n("d3b7"),n("3ca3"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("ddb0"),n("2b3d"),n("53ca")),o=n("1146"),c=n.n(o);function s(e){var t={SheetNames:[],Sheets:{}};for(var n in e){var a=c.a.utils.aoa_to_sheet(e[n]);t.SheetNames.push(n),t.Sheets[n]=a}var i={bookType:"xlsx",bookSST:!1,type:"binary"},l=c.a.write(t,i),o=new Blob([s(l)],{type:"application/octet-stream"});function s(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=255&e.charCodeAt(a);return t}return o}function r(e,t){"object"==Object(l["a"])(e)&&e instanceof Blob&&(e=URL.createObjectURL(e));var n,a=document.createElement("a");a.href=e,a.download=t||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),a.dispatchEvent(n)}var u={name:"excel",components:{},data:function(){return{tableData:[],fileList:[],excelList:[],fileRule:null,fileDate:null,fileTa:null,totleSum:0}},created:function(){this.getAccountDate()},methods:{ondownload:function(e){window.open(window.location.origin+"/dist/"+e.name)},handleRequest:function(){console.log(this.fileList)},handleChangefileRule:function(e){this.fileRule=e.raw},handleChangefileDate:function(e){this.fileDate=e.raw},handleChangefileTa:function(e){this.fileTa=e.raw},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(){this.$message.warning("当前限制选择 1 个文件")},beforeRemove:function(e){return this.$confirm("确定移除 ".concat(e.name,"？"))},getAccountDate:function(){},excelCreatedAndDownload:function(e,t){r(s(e),(t||"导出数据")+".xlsx")},onSubmit:function(){var e=this;if(this.fileRule)if(this.fileDate){var t=new FormData;t.append("fileRule",this.fileRule),t.append("fileDate",this.fileDate),this.$http({method:"post",url:"/searchTest",data:t}).then((function(t){e.excelCreatedAndDownload(t.data)}))}else this.$message("请输入需要待转换表");else this.$message("请输入规则表")},onSubmitTa:function(){var e=this;if(this.fileRule)if(this.fileTa){var t=new FormData;t.append("fileRule",this.fileRule),t.append("fileTa",this.fileTa),this.$http({method:"post",url:"/tamaker",data:t}).then((function(t){e.excelCreatedAndDownload(t.data,"天安转换后数据")}))}else this.$message("请输入天安原始表");else this.$message("请输入规则表")}}},d=u,f=n("2877"),h=Object(f["a"])(d,a,i,!1,null,null,null);t["default"]=h.exports},b0c0:function(e,t,n){var a=n("83ab"),i=n("9bf2").f,l=Function.prototype,o=l.toString,c=/^\s*function ([^ (]*)/,s="name";a&&!(s in l)&&i(l,s,{configurable:!0,get:function(){try{return o.call(this).match(c)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-ec8d9eb4.33b11733.js.map