{"version":3,"sources":["webpack:///./src/components/test.vue?14e7","webpack:///src/components/test.vue","webpack:///./src/components/test.vue?e24b","webpack:///./src/components/test.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","getExcel","_v","attrs","staticRenderFns","sheet2blob","sheet","sheetName","openDownloadDialog","url","saveName","name","created","methods","excelCreatedAndDownload","aoa","$http","console","log","res","blob","Blob","data","reader","FileReader","readAsDataURL","onload","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,SAAS,CAACF,EAAG,SAAS,CAACG,GAAG,CAAC,MAAQP,EAAIQ,WAAW,CAACR,EAAIS,GAAG,aAAaL,EAAG,IAAI,CAACE,YAAY,yBAAyBI,MAAM,CAAC,KAAO,cAAc,KAAO,WAAW,CAACV,EAAIS,GAAG,WAC5RE,EAAkB,G,qUCQtB,SAASC,EAAWC,EAAOC,GAC3B,cACA,OACA,eACA,WAEA,cAEA,OACA,gBACA,WACA,eAEA,iBACA,qDAEA,cAGA,IAFA,gCACA,oBACA,6CACA,SAEA,SAGA,SAASC,EAAmBC,EAAKC,GAEjC,iDAEA,0BAEA,IAGA,EAHA,8BACA,SACA,iBAEA,6CAGA,sCACA,qEAEA,mBAGA,OACEC,KAAM,OACNC,QAFF,aAIEC,QAAS,CACPC,wBADJ,WAEM,IAAIC,EAAM,CAChB,wBACA,uBACA,wBAEUT,EAAQ,EAAlB,wBACME,EAAmBH,EAAWC,GAAQ,YAExCL,SAVJ,WAWMP,KAAKsB,MAAM,CACT,OAAR,MACQ,IAAR,cACQ,KAAR,KACA,kBACQC,QAAQC,IAAIC,GACZ,IAAIC,EAAO,IAAIC,KAAK,CAACF,EAAIG,MAAjC,mCACYC,EAAS,IAAIC,WACjBD,EAAOE,cAAcL,GACrBG,EAAOG,OAAS,SAAxB,GAEU,IAAV,8BACU,EAAV,yBACU,EAAV,qBAGU,IAAV,sCACU,EAAV,yBACU,EAAV,wBCtF8U,I,YCO1UC,EAAY,eACd,EACAnC,EACAY,GACA,EACA,KACA,WACA,MAIa,aAAAuB,E","file":"js/chunk-2d2163d7.b06e35aa.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hello\"},[_c('button',{on:{\"click\":_vm.getExcel}},[_vm._v(\"下载excel\")]),_c('a',{staticClass:\"btn btn-primary btn-sm\",attrs:{\"href\":\"/searchTest\",\"type\":\"button\"}},[_vm._v(\"模板\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"hello\">\n    <button @click=\"getExcel\">下载excel</button>\n    <a href=\"/searchTest\" class=\"btn btn-primary btn-sm\" type=\"button\">模板</a>\n  </div>\n</template>\n\n<script>\n// 将一个sheet转成最终的excel文件的blob对象，然后利用URL.createObjectURL下载\nfunction sheet2blob(sheet, sheetName) {\n\tsheetName = sheetName || 'sheet1';\n\tvar workbook = {\n\t\tSheetNames: [sheetName],\n\t\tSheets: {}\n\t};\n\tworkbook.Sheets[sheetName] = sheet;\n\t// 生成excel的配置项\n\tvar wopts = {\n\t\tbookType: 'xlsx', // 要生成的文件类型\n\t\tbookSST: false, // 是否生成Shared String Table，官方解释是，如果开启生成速度会下降，但在低版本IOS设备上有更好的兼容性\n\t\ttype: 'binary'\n\t};\n\tvar wbout = XLSX.write(workbook, wopts);\n\tvar blob = new Blob([s2ab(wbout)], {type:\"application/octet-stream\"});\n\t// 字符串转ArrayBuffer\n\tfunction s2ab(s) {\n\t\tvar buf = new ArrayBuffer(s.length);\n\t\tvar view = new Uint8Array(buf);\n\t\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\t\treturn buf;\n\t}\n\treturn blob;\n}\n\nfunction openDownloadDialog(url, saveName)\n{\n\tif(typeof url == 'object' && url instanceof Blob)\n\t{\n\t\turl = URL.createObjectURL(url); // 创建blob地址\n\t}\n\tvar aLink = document.createElement('a');\n\taLink.href = url;\n\taLink.download = saveName || ''; // HTML5新增的属性，指定保存文件名，可以不要后缀，注意，file:///模式下不会生效\n\tvar event;\n\tif(window.MouseEvent) event = new MouseEvent('click');\n\telse\n\t{\n\t\tevent = document.createEvent('MouseEvents');\n\t\tevent.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n\t}\n\taLink.dispatchEvent(event);\n}\nimport XLSX from 'xlsx';\nexport default {\n  name: 'test',\n  created() {\n  },\n  methods: {\n    excelCreatedAndDownload(){\n      var aoa = [\n        ['姓名', '性别', '年龄', '注册时间'],\n        ['张三', '男', 18, new Date()],\n        ['李四', '女', 22, new Date()]\n      ];\n      var sheet = XLSX.utils.aoa_to_sheet(aoa);\n      openDownloadDialog(sheet2blob(sheet), '导出.xlsx');\n    },\n    getExcel(){\n      this.$http({\n          method: 'get',\n          url: '/searchTest',\n          data: {}\n      }).then(res=>{\n        console.log(res)\n        var blob = new Blob([res.data],{type:\"text/plain;charset=utf-8\"}); \n        var reader = new FileReader();\n        reader.readAsDataURL(blob);\n        reader.onload = function(e) {\n            // 转换完成，创建一个a标签用于下载\n            var a = document.createElement('a');\n            a.download = 'filename.xlsx';\n            a.href = e.target.result;\n\n            // 兼容触发click\n            var evt = document.createEvent(\"MouseEvents\");\n            evt.initEvent(\"click\", true, true);\n            a.dispatchEvent(evt);\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./test.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./test.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./test.vue?vue&type=template&id=1b40ad96&scoped=true&\"\nimport script from \"./test.vue?vue&type=script&lang=js&\"\nexport * from \"./test.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1b40ad96\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}